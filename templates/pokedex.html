<!DOCTYPE html>
  <html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Pokémon</title>
    <link rel="icon" href="/static/img/earth.png" type="image/png">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="/static/css/styles.css">
  </head>
      <div class="bg-image"></div>
      <div class="overlay"></div>
    <body>

      <!-- Header start -->
      <header>
        <!-- Logo-container start -->
        <div class="logo-container">
            <img src="/static/img/logo.png" alt="Logo de la pagina">
        </div>
        <!-- Logo-container end -->

        <!-- Links container start -->
        <div class="links">
            <a href="/">Inicio</a>
            <a href="/pokedex">Pokédex</a>
            <!-- Dropdown container start -->
            <div class="dropdown">
                <a href="#" class="dropbtn" id="info-btn">Información</a>
                <div class="dropdown-content">
                    <div class="column">
                        <h5>Juegos</h5>
                        <a href="/Walkthroughts.html">Walkthroughts</a>
                        <a href="#">Pokémon Legends: Arceus</a>
                        <a href="#">Pokémon Brilliant and Shining Pearl</a>
                        <a href="#">Espada y Escudo</a>
                        <a href="#">Spin Offs</a>
                        <a href="#">GO</a>
                    </div>
                    <div class="column">
                        <h5>Mecánicas</h5>
                        <a href="#">Tipos</a>
                        <a href="#">Tabla de tipos</a>
                        <a href="#">Habilidades</a>
                        <a href="#">Naturaleza</a>
                        <a href="#">Movimientos</a>
                        <a href="#">Objetos</a>
                    </div>
                    <div class="column">
                        <h5>Anime y manga</h5>
                        <a href="#">Ash Ketchum</a>
                        <a href="#">Anime</a>
                        <a href="#">Personajes del anime</a>
                        <a href="#">Episodios</a>
                        <a href="#">Películas</a>
                        <a href="#">Manga</a>
                    </div>
                    <div class="column">
                    <h5>TCG</h5>
                        <a href="#">Acerca de...</a>
                        <a href="#">Cómo jugar</a>
                        <a href="#">Rotación</a>
                        <a href="#">Cartas promocionales</a>
                        <a href="#">Estrellas brillantes</a>
                        <a href="#">Fusion strike</a>
                    </div>
                    <!-- Column container end -->
                </div>
                <!-- Dropdown-content container end -->
            </div>
            <!-- Dropdown container end -->
          
                <!-- Search bar start-->
                <form action="" class="search-bar">
                    <input type="text" class="search">
                    <button><i class='bx bx-search'></i></button>
                </form>
        </div>
        <!-- Links container end -->
    </header>
        <div class="title">
          <h1>Pokédex</h1>
        </div>
      <div id="pokemon-list"></div>
      <a href="/add" class="back">Añadir nuevo Pokémon</a>


      <script>
        // Función para cargar la lista de Pokémon
        async function cargarPokemons() {
          const container = document.getElementById('pokemon-list');
          container.innerHTML = ''; // Limpiar contenido previo

          try {
            const response = await fetch('/api/pokemons');
            const data = await response.json();

            data.forEach((pokemon) => {
              const pokemonCard = document.createElement('div');
              pokemonCard.className = 'pokemon-card';
              pokemonCard.innerHTML = `
                <h2><strong>No.</strong> ${pokemon.id}</h2>
                <h2>${pokemon.nombre}</h2>
                <img src="${pokemon.imagen}" alt="${pokemon.nombre}" />
                <p><strong>Tipo:</strong> ${pokemon.tipo.join(', ')}</p>
                <p><strong>Altura:</strong> ${pokemon.altura} m</p>
                <p><strong>Peso:</strong> ${pokemon.peso} kg</p>
                <p><strong>Habilidad:</strong> ${pokemon.habilidad}</p>
                <p><strong>Descripción:</strong> ${pokemon.descripcion}</p>
                <p><strong>Sexo:</strong> ${pokemon.sexo.join(', ')}</p>
                <button class="delete-button" onclick="eliminarPokemon('${pokemon.id}')">Eliminar</button>
              `;
              container.appendChild(pokemonCard);
            });
          } catch (error) {
            console.error('Error al cargar Pokémon:', error);
          }
        }

        // Función para eliminar un Pokémon
        async function eliminarPokemon(id) {
          const confirmacion = confirm('¿Estás seguro de que deseas eliminar este Pokémon?');
          if (!confirmacion) return;

          try {
            const response = await fetch(`/api/pokemons/${id}`, {
              method: 'DELETE',
            });

            if (response.ok) {
              alert('Pokémon eliminado con éxito');
              cargarPokemons(); // Recargar la lista después de eliminar
            } else {
              const errorData = await response.json();
              alert(`Error al eliminar el Pokémon: ${errorData.message}`);
            }
          } catch (error) {
            console.error('Error al eliminar Pokémon:', error);
            alert('Error al eliminar Pokémon');
          }
        }

        // Cargar la lista de Pokémon al cargar la página
        window.onload = cargarPokemons;
      </script>

      <!-- Footer with our social media start-->
      <footer>
          <div class="social-media"><i class='bx bxl-instagram-alt'></i></div>
          <div class="social-media"><i class='bx bxl-facebook-circle'></i></div>
          <div class="social-media"><i class='bx bxl-youtube'></i></div>
          <div class="social-media"><i class='bx bxl-pinterest' ></i></div>
      </footer>
    </body>
    </html>

